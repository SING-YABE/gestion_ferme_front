
<div>
  <div *ngIf="files.length > 0">
    <h3>Les fichiers attachés</h3>
    <ul class="list-group">
      <li *ngFor="let file of files" class="list-group-item d-flex justify-content-between align-items-center mb-2">

        <span class="text-truncate" style="max-width: 70%;">{{ file.fileName }}</span>
       <!-- <span class="text-muted">{{ file.size | number: '1.0' }} </span>-->

        <!-- Icons -->
        <i class="pi pi-download text-primary"
           style="cursor: pointer; font-size: 1.2rem; margin-left: 10px;"
           (click)="downloadFiles(file.downloadUrl.split('/').pop(), file.fileName)"
           title="Télécharger">
        </i>
      </li>
    </ul>
  </div>

  <!-- Section pour uploader de nouveaux fichiers -->
  <div (click)="upload.click()" class="surface-100 border-1 select-none cursor-pointer border-dashed mb-2 p-3 text-center">
    <span>Cliquez pour charger les documents</span>
    <input (change)="handleDocuments($event)" type="file" hidden="hidden" #upload>
  </div>

</div>


<p-sidebar [dismissible]="!processing" styleClass="w-5" appendTo="body" [(visible)]="showFilesToUpload" position="right" [modal]="true">

  <ng-template pTemplate="header">
    <h3 class="m-0 w-full">Fichier à charger</h3>
  </ng-template>

  <div>

    @for (file of files; track $index){
      <div class="p-3 surface-100 border-bottom-1 text-black">
        <div>
          {{ file.name }}
        </div>
      </div>
    }

    <div class="mt-3">
      Taille total : {{ totalSize/1000000 | number:'':'fr-FR' }} MB
    </div>

  </div>

  <ng-template pTemplate="footer">
    <button [loading]="processing" icon="pi pi-times" class="p-button-danger mr-2 p-button-outlined" (click)="showFilesToUpload = false" pButton label="Annuler"></button>
    <button [loading]="processing" (click)="handleUploadFiles()" icon="pi pi-upload" class="p-button-contrast" pButton label="Envoyer"></button>
  </ng-template>

</p-sidebar>

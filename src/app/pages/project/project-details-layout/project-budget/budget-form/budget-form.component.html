

<button style="background-color: rgba(0,0,0,0.42); margin-bottom: 20px !important; margin-right: 13px" *ngIf="mode == 'create'" (click)="handleShowForm()" icon="pi pi-plus" class="p-button-sm" pButton label="Nouvelle dépense"></button>

<p-dialog [modal]="true" appendTo="body" header="Dépense" [style]="{width: '600px'}" [(visible)]="showForm">

  <form id="depenseForm" [formGroup]="depenseForm" (ngSubmit)="handleSaveBudget()">

    <div class="field">
      <label for="type">
        Ligne budgetaire
      </label>
      <p-dropdown filterBy="label,direction.name" [filter]="true" id="type" optionValue="id" formControlName="annualBudgetId" [options]="lignes">
        <ng-template pTemplate="item" let-item>
          <div class="flex align-items-center gap-2">
            <fa-icon [icon]="faMoneyBills"></fa-icon>
            <div class="flex-1">{{ item.year }} - {{ item.label }} - {{ item.direction.name }}</div>
            <div class="mr-2"><p-badge [value]="item.type"></p-badge></div>
          </div>
        </ng-template>

        <ng-template pTemplate="selectedItem" let-selectedOption>
          <div class="flex align-content-start gap-2">
            <div class="flex-1">
              <fa-icon [icon]="faMoneyBills"></fa-icon>
              {{ selectedOption.year }} - {{ selectedOption.label }} - {{ selectedOption.direction.name }}
            </div>
          </div>
        </ng-template>
      </p-dropdown>
    </div>

    <div class="field">
      <label for="label">Date de la dépense</label>
      <p-calendar formControlName="dateDepense" appendTo="body" type="text" id="dateDepense"></p-calendar>
    </div>


    <div class="field">
      <label for="label">Libellé</label>
      <input id="label" formControlName="label" type="text" pInputText>
    </div>

    <div class="field">
      <label for="description">Description</label>
      <input id="description" formControlName="description" type="text" pInputText>
    </div>

    <div class="field">
      <label for="amount">Montant</label>
      <input id="amount" formControlName="amount" type="number" pInputText>
    </div>

  </form>

  <ng-template pTemplate="footer">
    <button class="mr-2 p-button-outlined p-button-danger" pButton label="Annuler" (click)="showForm = false"></button>
    <button [loading]="processing" [disabled]="!depenseForm.valid" type="submit" form="depenseForm" pButton label="Enregister"></button>
  </ng-template>

</p-dialog>

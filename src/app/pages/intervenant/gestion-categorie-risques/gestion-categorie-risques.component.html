<div class="odyssey-shadow-low bg-white border-round">
  <!-- En-tête -->
  <div class="px-4 py-2 flex gap-3 align-items-center">
    <div class="flex-1">
      <h5 class="m-0">Gestion des types des risques</h5>
    </div>
    <div fxFlex="300px">
      <input type="search" pInputText class="w-full" placeholder="Rechercher un type de risque" />
    </div>
    <div>
      <app-categorie-risques-form (onUpdate)="loadData()"></app-categorie-risques-form>
    </div>
  </div>

  <div>
    <p-table 
      [loading]="loading" 
      [lazy]="true" 
      [rows]="10" 
      (onLazyLoad)="handleNext($event)" 
      [rowsPerPageOptions]="[10, 30, 40]" 
      [value]="categorieRisques" 
      [paginator]="true"
    >
      <ng-template pTemplate="header">
        <tr>
          <th pSortableColumn="name">Nom du type <p-sortIcon field="name"></p-sortIcon></th>
          <th pSortableColumn="description">Description <p-sortIcon field="description"></p-sortIcon></th>
          <th style="text-align: center;">Actions</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-categorie>
        <tr>
          <td>
            <span class="p-column-title">Nom du type</span>
            <strong>{{ categorie.name }}</strong>
          </td>
          <td>
            <span class="p-column-title">Description</span>
            <span>{{ categorie.description || 'Non défini' }}</span>
          </td>
          <td>
            <div class="flex gap-2 justify-content-center">
              <app-categorie-risques-form 
                [target]="categorie" 
                mode="edit" 
                (onUpdate)="loadData()"
              ></app-categorie-risques-form>
              <button 
                pButton 
                class="p-button-danger p-button-rounded" 
                icon="pi pi-trash" 
                (click)="confirmDelete(categorie.id)"
              ></button>
            </div>
          </td>
        </tr>
      </ng-template>

      <ng-template pTemplate="emptymessage">
        <tr>
          <td colspan="3" class="text-center">Aucun type de risque trouvé</td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>

<p-confirmDialog></p-confirmDialog>

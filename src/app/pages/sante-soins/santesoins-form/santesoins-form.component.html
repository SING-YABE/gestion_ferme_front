<button *ngIf="mode === 'create'" pButton icon="pi pi-plus" label="Nouveau soin" class="p-button-success"
  style="background:#2E7D32; border-color:#2E7D32;" (click)="handleShow()">
</button>

<button *ngIf="mode === 'edit'" pButton icon="pi pi-pencil" class="p-button-rounded"
  style="background:#4CAF50; border-color:#4CAF50;" (click)="handleShow()">
</button>


  <p-dialog [(visible)]="showForm" [modal]="true" appendTo="body" header="Soin de Santé"
          [style]="{width: '800px'}" styleClass="farm-dialog" [baseZIndex]="10000">


  <form [formGroup]="form" id="soinsForm" (ngSubmit)="handleSubmit()">

    <!-- Soin collectif -->
    <div class="field mb-4 flex align-items-center gap-2">
      <p-checkbox [(ngModel)]="isSoinCollectif" [ngModelOptions]="{standalone: true}" [binary]="true"
        inputId="soinCollectif" (onChange)="onSoinCollectifChange()"></p-checkbox>
      <label for="soinCollectif" class="mb-0" style="cursor: pointer;">
        <strong style="color:#F59E0B;">Soin collectif (pour tous les animaux)</strong>
      </label>
    </div>

    <!-- Code Animal et Date en deux colonnes -->
    <div class="grid formgrid mb-3">
      <div class="col-6" *ngIf="!isSoinCollectif">
        <div class="field">
          <label class="font-semibold">Code Animal *</label>
          <input pInputText formControlName="codeAnimal" placeholder="P3"
            style="width: 100%; height: 55px; font-size: 1rem; padding: 0.5rem; text-transform: uppercase;">
          <small class="block mt-1" style="color:#6B7280;">
            Laissez vide ou cochez "Soin collectif" pour un traitement de groupe
          </small>

        </div>
      </div>

      <div class="col-6">
        <div class="field">
          <label>Date du soin <span style="color: red;">*</span></label>
<p-calendar formControlName="dateSoin" dateFormat="dd/mm/yy" [showIcon]="true"
            [appendTo]="'body'" [touchUI]="true" inputId="date"
            [style]="{'width': '100%'}">
</p-calendar>


        </div>
      </div>
    </div>

    <!-- Motif et Traitement -->
    <div class="grid formgrid mb-3">
      <div class="col-6">
        <div class="field">
          <label class="font-semibold">Motif *</label>
          <textarea pInputTextarea rows="2" formControlName="motif" placeholder="Vaccination"
            style="width: 100%; font-size: 1rem; padding: 0.5rem;"></textarea>
        </div>
      </div>
      <div class="col-6">
        <div class="field">
          <label class="font-semibold">Traitement *</label>
          <textarea pInputTextarea rows="2" formControlName="traitement" placeholder="Vectocid"
            style="width: 100%; font-size: 1rem; padding: 0.5rem;"></textarea>
        </div>
      </div>
    </div>

    <!-- Coût et Vétérinaire -->
    <div class="grid formgrid mb-3">
      <div class="col-6">
        <div class="field">
          <label class="font-semibold">Coût (FCFA) *</label>
          <input pInputText type="number" formControlName="cout" (input)="formatCout()"
            style="width: 100%; height: 40px; font-size: 1rem; padding: 0.5rem;">
          <div class="mt-2 flex gap-2 flex-wrap">
            <button *ngFor="let c of coutPresets" pButton type="button" class="p-button-outlined p-button-sm"
              style="border-color:#2E7D32; color:#2E7D32;" (click)="applyCout(c)">
              {{ c | number }} FCFA
            </button>
          </div>
        </div>
      </div>

      <div class="col-6">
        <div class="field">
          <label class="font-semibold">Vétérinaire *</label>
          <input pInputText formControlName="veterinaire" placeholder="Dr KABORE"
            style="width: 100%; height: 40px; font-size: 1rem; padding: 0.5rem;">
        </div>
      </div>
    </div>

    <!-- Observations -->
    <div class="field mb-3">
      <label class="font-semibold">Observations</label>
      <textarea pInputTextarea rows="4" formControlName="observations" placeholder="Détails du traitement"
        style="width: 100%; font-size: 1rem; padding: 0.5rem;"></textarea>
    </div>

  </form>

  <!-- Footer -->
  <ng-template pTemplate="footer">
    <button pButton class="p-button-outlined mr-2" style="color:#2E7D32; border-color:#2E7D32;"
      (click)="showForm = false">
      Annuler
    </button>

    <button pButton class="p-button-success" form="soinsForm" type="submit" [loading]="processing"
      [disabled]="!form.valid" style="background:#1B5E20; border-color:#1B5E20;">
      Enregistrer
    </button>
  </ng-template>

</p-dialog>
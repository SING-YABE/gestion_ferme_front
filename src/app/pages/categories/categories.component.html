<!-- src/app/pages/categories/categories.component.html -->
<div class="card">
  <p-toast></p-toast>
  <p-confirmDialog></p-confirmDialog>

  <!-- En-tête avec bouton d'ajout -->
  <div class="flex justify-content-between align-items-center mb-4">
    <h2>Gestion des Catégories d'Équipement</h2>
    <p-button 
      icon="pi pi-plus" 
      label="Nouvelle Catégorie" 
      (click)="openAddModal()">
    </p-button>
  </div>

  <!-- Tableau des catégories -->
  <p-table 
    [value]="categories" 
    [paginator]="true" 
    [rows]="10"
    [showCurrentPageReport]="true"
    currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
    [rowsPerPageOptions]="[10,25,50]">
    
    <ng-template pTemplate="header">
      <tr>
        <th>ID</th>
        <th>Nom</th>
        <th>Nombre d'équipements</th>
        <th>Actions</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-categorie>
      <tr>
        <td>{{ categorie.idCategorieEquipement }}</td>
        <td>{{ categorie.nom }}</td>
        <td>{{ categorie.equipements?.length || 0 }}</td>
        <td>
          <div class="flex gap-2">
            <p-button 
              icon="pi pi-pencil" 
              severity="warning" 
              (click)="openEditModal(categorie)">
            </p-button>
            <p-button 
              icon="pi pi-trash" 
              severity="danger" 
              (click)="confirmDelete(categorie)">
            </p-button>
          </div>
        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="4" class="text-center">Aucune catégorie trouvée</td>
      </tr>
    </ng-template>
  </p-table>

  <!-- Modal Ajout/Modification -->
  <p-dialog 
    [(visible)]="displayModal" 
    [style]="{ width: '500px' }"
    [header]="getModalTitle()"
    [modal]="true"
    [draggable]="false"
    [resizable]="false">
    
    <div class="field">
      <label for="nom" class="block font-medium mb-2">Nom de la catégorie *</label>
      <input 
        id="nom"
        type="text" 
        pInputText 
        [(ngModel)]="categorieForm.nom"
        class="w-full"
        placeholder="Entrez le nom de la catégorie"
        required>
    </div>

    <ng-template pTemplate="footer">
      <p-button 
        label="Annuler" 
        icon="pi pi-times" 
        (click)="displayModal = false" 
        severity="secondary">
      </p-button>
      <p-button 
        [label]="isEditMode ? 'Modifier' : 'Ajouter'" 
        icon="pi pi-check" 
        (click)="submitForm()" 
        [disabled]="!categorieForm.nom">
      </p-button>
    </ng-template>
  </p-dialog>
</div>